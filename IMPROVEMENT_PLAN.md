# EduGenius 功能完善计划

## 📅 开发时间线 (总计 37 天)

---

## 🔥 阶段一：MVP 核心功能 (优先级 P0) - 10 天

### 1.1 文档上传系统 (5 天)

#### 后端 (3 天)
- [ ] 创建文档上传 API (`POST /api/documents/upload`)
  - 支持 PDF 和 TXT 文件
  - 文件大小限制 (50MB)
  - 文件类型验证
  - 重复文件检测

- [ ] 实现 PDF 解析器
  - 提取文本内容
  - 保留章节结构
  - 提取公式和图表

- [ ] 实现 TXT 解析器
  - 编码检测 (UTF-8, GBK)
  - 章节识别
  - 清洗格式

- [ ] 文档分块和向量化
  - 智能分块 (按章节/段落)
  - ChromaDB 批量插入
  - 元数据关联 (document_id, chapter_number)

- [ ] 自动章节识别
  - 基于标题层级
  - 生成章节编号
  - 保存到 progress 表

#### 前端 (2 天)
- [ ] 文档上传页面 (`/documents/upload`)
  - 拖拽上传区域
  - 文件列表预览
  - 上传进度条
  - 错误提示

- [ ] 文档管理页面 (`/documents`)
  - 文档列表展示
  - 删除确认
  - 章节预览

### 1.2 基础答题系统 (4 天)

#### 后端 (2 天)
- [ ] 题目数据库设计
  ```sql
  CREATE TABLE questions (
      id INTEGER PRIMARY KEY,
      document_id INTEGER,
      chapter_number INTEGER,
      question_type TEXT,  -- choice, fill_blank, essay
      question_text TEXT,
      options TEXT,  -- JSON for multiple choice
      correct_answer TEXT,
      explanation TEXT,
      difficulty INTEGER  -- 1-5
  )
  ```

- [ ] 题目生成 API
  - AI 自动生成题目
  - 基于文档内容
  - 按章节分类
  - 难度自适应

- [ ] 答题提交 API (`POST /api/quiz/submit`)
  - 答案验证
  - 实时反馈
  - 保存到 quiz_attempts

- [ ] 章节测试 API (`POST /api/quiz/chapter-test`)
  - 随机抽题 (10-20 题)
  - 时间限制
  - 成绩计算

#### 前端 (2 天)
- [ ] 答题组件 (`components/Quiz/Quiz.tsx`)
  - 题目展示
  - 选项选择 (单选/多选)
  - 填空题输入
  - 提交按钮

- [ ] 答题结果页面
  - 成绩展示
  - 正确答案对比
  - 解析显示
  - 错题加入错题本

- [ ] 集成到学习流程
  - 章节学习后提示测试
  - Dashboard 快速入口

### 1.3 章节锁定机制 (1 天)

#### 后端 (0.5 天)
- [ ] 解锁规则配置
  ```python
  UNLOCK_RULES = {
      "completion_threshold": 0.7,  # 前置章节完成度 70%
      "quiz_score_threshold": 0.6,  # 测试分数 60%
      "min_time_minutes": 10        # 最少学习时间
  }
  ```

- [ ] 章节状态 API (`GET /api/documents/{id}/chapters`)
  - 返回每个章节的锁定状态
  - 检查解锁条件

#### 前端 (0.5 天)
- [ ] 侧边栏章节状态显示
  - 🔓 已解锁
  - 🔒 未解锁
  - ✅ 已完成

- [ ] 锁定章节点击提示
  - 显示解锁条件
  - 引导学习前置章节

---

## 🎯 阶段二：完善核心体验 (优先级 P1) - 18 天

### 2.1 AI 对话优化 (2 天)

- [ ] 上下文记忆增强
  - 保存最近 20 条对话
  - 章节主题关联
  - 用户偏好学习

- [ ] 流式响应优化
  - Markdown 实时渲染
  - LaTeX 公式支持
  - Mermaid 图表

- [ ] 多轮对话改进
  - 问题意图识别
  - 知识点关联
  - 循序渐进引导

### 2.2 能力评估系统 (4 天)

- [ ] 答题数据流打通
  - Quiz → QuizAttempts → 能力计算
  - 实时更新用户能力
  - Dashboard 展示

- [ ] 六维能力雷达图
  - 使用 Chart.js 或 Recharts
  - 动态更新
  - 历史对比

- [ ] 能力报告生成
  - AI 分析能力特点
  - 学习建议
  - 薄弱项提示

### 2.3 进度系统完善 (3 天)

- [ ] 学习时长统计
  - 页面停留时间追踪
  - 实际学习时间计算
  - 每日/每周统计

- [ ] 学习曲线图表
  - 进度变化趋势
  - 能力成长曲线
  - 学习热力图

- [ ] 里程碑系统
  - 首次登录
  - 完成首个章节
  - 测试达标

### 2.4 错题本功能 (3 天)

- [ ] 错题收集
  - 自动记录错题
  - 标注错误类型
  - 关联知识点

- [ ] 错题分类
  - 按章节分类
  - 按错误类型分类
  - 按难度分类

- [ ] 错题重练
  - 随机抽取
  - 专项练习
  - 掌握度标记

- [ ] 错题分析
  - 错误原因统计
  - 薄弱知识点识别
  - 复习建议

### 2.5 章节学习体验 (3 天)

- [ ] 文档内容展示
  - 左侧：原始文档
  - 右侧：AI 助手
  - 同步滚动

- [ ] 学习模式切换
  - 学习模式：AI 讲解
  - 练习模式：答题
  - 复习模式：错题

- [ ] 学习提示
  - 进度提醒
  - 休息建议
  - 完成祝贺

### 2.6 Dashboard 优化 (3 天)

- [ ] 首页数据大屏
  - 今日学习时长
  - 本周进度
  - 能力雷达图
  - 待办事项

- [ ] 学习建议卡片
  - AI 生成个性化建议
  - 推荐下一步学习
  - 薄弱项提醒

- [ ] 快速操作入口
  - 继续学习
  - 开始测试
  - 查看错题

---

## 🚀 阶段三：增值功能 (优先级 P2) - 9 天

### 3.1 知识图谱可视化 (3 天)
- [ ] 使用 D3.js 或 Cytoscape.js
- [ ] 章节关系图
- [ ] 知识点连接
- [ ] 学习路径标记

### 3.2 学习报告 (2 天)
- [ ] 周报/月报生成
- [ ] PDF 导出
- [ ] 学习曲线对比
- [ ] 成就展示

### 3.3 社交功能 (2 天)
- [ ] 学习排行榜
- [ ] 成就徽章
- [ ] 学习小组
- [ ] 分享功能

### 3.4 移动端适配 (2 天)
- [ ] 响应式设计优化
- [ ] 触摸交互
- [ ] PWA 支持

---

## 🧪 阶段四：质量保证 (优先级 P3) - 10 天

### 4.1 测试系统 (7 天)

#### 单元测试 (3 天)
- [ ] 后端 API 测试 (pytest)
- [ ] 前端组件测试 (Jest)
- [ ] 工具函数测试
- [ ] 目标覆盖率: 70%

#### 集成测试 (2 天)
- [ ] 用户流程测试
- [ ] API 集成测试
- [ ] 数据库测试

#### E2E 测试 (2 天)
- [ ] Playwright/Cypress
- [ ] 关键用户场景
- [ ] 回归测试

### 4.2 性能优化 (2 天)
- [ ] Redis 缓存
- [ ] 数据库索引优化
- [ ] 前端代码分割
- [ ] 图片懒加载

### 4.3 部署和监控 (1 天)
- [ ] Docker 容器化
- [ ] Nginx 配置
- [ ] 日志系统 (ELK)
- [ ] 错误监控 (Sentry)

---

## 📊 开发里程碑

| 里程碑 | 时间 | 交付内容 |
|--------|------|----------|
| M1: MVP | Day 10 | 可完整运行的学习系统 |
| M2: Beta | Day 28 | 功能完善的内测版本 |
| M3: RC | Day 37 | 生产就绪版本 |

---

## 🎯 每日开发检查清单

### 代码质量
- [ ] TypeScript 类型正确
- [ ] 无 ESLint 警告
- [ ] 组件有适当的错误处理
- [ ] API 调用有 loading 状态

### 功能测试
- [ ] 本地功能测试通过
- [ ] 前后端联调成功
- [ ] 数据正确保存到数据库

### 文档更新
- [ ] 更新 README
- [ ] 记录 API 变更
- [ ] 更新进度文档

---

## 🚨 风险和缓解

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| AI API 限流 | 高 | 添加请求队列和缓存 |
| 文档解析复杂度 | 中 | 先支持 TXT，再扩展 PDF |
| 前端性能 | 中 | 虚拟列表、懒加载 |
| 数据库性能 | 低 | 添加索引、查询优化 |

---

## 📝 下一步行动 (立即开始)

1. **今天**: 创建文档上传 API
2. **明天**: 实现前端上传页面
3. **本周**: 完成基础答题系统
4. **下周**: 实现章节锁定和测试

---

*最后更新: 2026-01-28*
*预计完成: 2026-03-05 (按每天 3-4 小时开发时间)*
